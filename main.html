<!DOCTYPE html>
<html>
  <head>

    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>My Weather App</title>
    <script
      src="https://code.jquery.com/jquery-2.2.4.min.js"
      integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
      crossorigin="anonymous">
    </script>

  </head>

  <body>

    <script>

    if (confirm("Allow localisation") == true) {
      $.getJSON("http://ip-api.com/json/?fields=city,country,lat,lon", function getUserLocation(data) {
        $('#city').html(data.city);
        $('#country').html(data.country);
        var lat = data.lat;
        var lon = data.lon;

          function getWeatherData(lat, lon) {
            var apiKey = "YOURAPIKEY";
            var exclude = "?exclude=minutely,alerts,flags";
            var unit ="?units=si";
            var url = "https://api.darksky.net/forecast/" + apiKey + "/" + lat + "," + lon + exclude + unit;

            $.ajax({
              url: url,
              dataType: "jsonp",
              success: function(weatherData) {
                //change icon id to match weatherData
                document.getElementById('icon').id = weatherData.currently.icon;
                //define and play icon
                var icons = new Skycons({"resizeClear": true}),
                    list  = [
                      "clear-day", "clear-night", "partly-cloudy-day",
                      "partly-cloudy-night", "cloudy", "rain", "sleet", "snow", "wind",
                      "fog"
                    ],
                    i;
                for(i = list.length; i--; )
                  icons.set(list[i], list[i]);
                  icons.play();

                // Display unmodified data
                $('#currentWeather').text(weatherData.currently.summary);
                $('#hourlyWeather').text(weatherData.hourly.summary);

                // Create variables for celsius and farenheit
                var temp = Math.round(weatherData.currently.temperature)
                var f = Math.round(weatherData.currently.temperature) + '째F';
                var c = Math.round((temp - 32) * 5/9) + '째C';

                // Display temperature in celsius
                $('#currentTemp').text(c);

                // Display summary in celsius
                var fSum = weatherData.daily.summary;
                var n = /\d+/;
                var cSum = fSum.replace((fSum.match(n)),Math.round(((fSum.match(n) - 32)) * 5/9)).replace(/째F/,'째C');
                $('#dailyWeather').text(cSum);

                // convert temperature button
                $('#convertTemp').on('click',function(event){
                  //convert temperature
                  if ('#currentTemp'.text = c) {
                    $('#currentTemp').text(f);
                  } else {
                    $('#currentTemp').text = c;
                  };
                  //convert summary
                  if ('#dailyWeather'.text = cSum) {
                    $('#dailyWeather').text(fSum);
                  } else {
                    $('#dailyWeather').text(cSum);
                  }
                });
              }
            });
          }
        getWeatherData(lat, lon);
      });
    } else {
      alert("Please refresh and allow localisation");
    }
    </script>

    <div id="city"></div>
    <div id="country"></div>
    <figure class="icons">
            <canvas id="icon" width="64" height="64">
            </canvas>
          </figure>
    <div id="currentTemp"></div>
    <button id="convertTemp">convertTemp</button>
    <div id="currentWeather"></div>
    <div id="hourlyWeather"></div>
    <div id="dailyWeather"></div>

<script src="skycons.js"></script>
  </body>
</html>
